现在我们的开发方式都是采用前后端分离的方式，因此后端一般都只提供数据，这就造成前后端域名不同，存在跨域请求的问题，浏览器为了安全方面考虑，对跨域请求有限制。为了避免非同源请求的失败，我们需要采取跨域资源共享 CORS 来解决这个问题。

## 安装 koa2-cors

```TypeScript
yarn add koa2-cors
yarn add -D @types/koa2-cors
```

## 配置跨域认证

```TypeScript
// src/app.ts
import KoaCors from 'koa2-cors';

app.use(
  KoaCors({
    origin: '*', // 设置允许的域名，*表示允许任何域名使用
    allowMethods: ['*'], // 设置允许的请求方法，*表示允许任何请求方法
    allowHeaders: ['*'], // 设置允许的请求头，*表示允许任何请求头
    credentials: true, //是否允许发送Cookie
  }),
);

```

浏览器在发送跨域请求的时候，当第一次请求到此域名时，会先发送一个 Option 请求，这个请求的作用是询问服务器是否支持跨域请求，以及支持哪些跨域请求的参数。

- origin：这里配置的事允许跨域的域名，即支持哪些域名访问本服务器。
- allowMethods：允许的请求方法。
- allowHeaders：支持的请求头信息，不支持的请求头会过滤掉。

以上三个选项是主要的跨域请求配置，我们在这里全部设置为*号，表示允许所有的参数及域名，防止开发过程中出现一些异常错误，但是在实际部署中，我们可以根据实际情况配置具体的数据。